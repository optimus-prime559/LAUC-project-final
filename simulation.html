<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Simulation – Fourier’s Law Heat Flow</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:linear-gradient(135deg,#c9f7f5,#e6fffa);
}

header{
    background:#06b6d4;
    color:white;
    padding:18px;
    text-align:center;
}

.container{
    display:grid;
    grid-template-columns:1fr 1.5fr 1.5fr;
    gap:16px;
    padding:16px;
}

.panel{
    background:rgba(255,255,255,0.45);
    backdrop-filter:blur(12px);
    padding:16px;
    border-radius:16px;
    box-shadow:0 10px 25px rgba(0,0,0,0.25);
}

h3{
    margin-top:0;
    border-bottom:2px solid #ddd;
    padding-bottom:6px;
}

input, select{
    width:100%;
    padding:8px;
    margin:6px 0;
}

button{
    width:100%;
    padding:10px;
    background:#fd7e14;
    color:white;
    border:none;
    font-weight:bold;
    cursor:pointer;
    border-radius:8px;
}

.result{
    background:rgba(255,255,255,0.7);
    padding:12px;
    border-left:5px solid #06b6d4;
}

canvas{
    background:white;
    margin-top:10px;
    border-radius:10px;
}

.small{
    font-size:13px;
}
</style>
</head>

<body>

<header>
    <h1>Heat Conduction Simulation (Cylindrical Pipe)</h1>
</header>

<div class="container">

<!-- INPUT -->
<div class="panel">
<h3>Input Parameters</h3>

<label>Inner Radius</label>
<input id="r1" value="5">
<select id="r1unit"><option value="0.01">cm</option><option value="1">m</option></select>

<label>Outer Radius</label>
<input id="r2" value="7">
<select id="r2unit"><option value="0.01">cm</option><option value="1">m</option></select>

<label>Radius for Temperature</label>
<input id="rq" value="6">
<select id="rqunit"><option value="0.01">cm</option><option value="1">m</option></select>

<label>Inner Temperature (°C)</label>
<input id="T1" value="200">

<label>Outer Temperature (°C)</label>
<input id="T2" value="50">

<label>Thermal Conductivity (W/m·K)</label>
<input id="k" value="45">

<label>Pipe Length (m)</label>
<input id="L" value="1">

<label>Time (s)</label>
<input id="time" value="60">

<label>Output Unit</label>
<select id="unit">
    <option value="W">Watt</option>
    <option value="cal">cal/sec</option>
</select>

<button onclick="calculate()">Calculate</button>
</div>

<!-- DIAGRAM -->
<div class="panel">
<h3>Pipe Cross-Section</h3>
<canvas id="pipeCanvas" width="300" height="300"></canvas>
<p class="small">Red = inner hot surface | Blue dashed = selected radius</p>
</div>

<!-- RESULTS -->
<div class="panel">
<h3>Results & Graphs</h3>
<div id="results" class="result"></div>
<canvas id="tempChart"></canvas>
<canvas id="timeChart"></canvas>
</div>

</div>

<script>
let tempChart=null;
let timeChart=null;

function drawPipe(r1,r2,rq){
    const c=document.getElementById("pipeCanvas");
    const ctx=c.getContext("2d");
    ctx.clearRect(0,0,300,300);

    const cx=150, cy=150;
    const scale=110/r2;

    const R1=r1*scale;
    const R2=r2*scale;
    const RQ=rq*scale;

    const grad=ctx.createRadialGradient(cx,cy,R1,cx,cy,R2);
    grad.addColorStop(0,"#ff5722");
    grad.addColorStop(1,"#ffffff");

    ctx.beginPath();
    ctx.arc(cx,cy,R2,0,2*Math.PI);
    ctx.fillStyle=grad;
    ctx.fill();

    ctx.beginPath();
    ctx.arc(cx,cy,R1,0,2*Math.PI);
    ctx.fillStyle="#fff";
    ctx.fill();
    ctx.stroke();

    ctx.beginPath();
    ctx.moveTo(cx,cy);
    ctx.lineTo(cx+R1,cy);
    ctx.moveTo(cx,cy);
    ctx.lineTo(cx+R2,cy);
    ctx.stroke();

    ctx.font="14px Arial";
    ctx.fillText("r = "+r1.toFixed(3)+" m",cx+R1/2-30,cy-5);
    ctx.fillText("r = "+r2.toFixed(3)+" m",cx+R2/2-30,cy+15);

    ctx.setLineDash([6,4]);
    ctx.beginPath();
    ctx.arc(cx,cy,RQ,0,2*Math.PI);
    ctx.strokeStyle="#0b5ed7";
    ctx.lineWidth=2;
    ctx.stroke();
    ctx.setLineDash([]);
}

function calculate(){
    const r1=document.getElementById("r1").value * document.getElementById("r1unit").value;
    const r2=document.getElementById("r2").value * document.getElementById("r2unit").value;
    const rq=document.getElementById("rq").value * document.getElementById("rqunit").value;

    const T1=Number(document.getElementById("T1").value);
    const T2=Number(document.getElementById("T2").value);
    const k=Number(document.getElementById("k").value);
    const L=Number(document.getElementById("L").value);
    const time=Number(document.getElementById("time").value);
    const unit=document.getElementById("unit").value;

    if(rq<r1 || rq>r2){
        document.getElementById("results").innerHTML="<b style='color:red'>Selected radius must lie between inner and outer radius</b>";
        return;
    }

    const Q=(2*Math.PI*k*L*(T1-T2))/Math.log(r2/r1);
    const Qout=(unit==="cal") ? Q/4.186 : Q;

    const Tr=T1+(T2-T1)*Math.log(rq/r1)/Math.log(r2/r1);
    const Qrq=Qout*Math.log(rq/r1)/Math.log(r2/r1);

    document.getElementById("results").innerHTML=
        "<b>Heat Flow Rate:</b> "+Qout.toFixed(3)+" "+(unit==="cal"?"cal/sec":"W")+"<br>"+
        "<b>Heat Transferred after "+time+" s:</b> "+(Qout*time).toFixed(3)+"<br>"+
        "<b>Heat Transferred up to selected radius:</b> "+Qrq.toFixed(3)+"<br>"+
        "<b>Temperature at selected radius:</b> "+Tr.toFixed(2)+" °C";

    drawPipe(r1,r2,rq);

    const rArr=[], tArr=[];
    for(let i=0;i<=20;i++){
        const r=r1+(r2-r1)*i/20;
        rArr.push(r.toFixed(4));
        tArr.push(T1+(T2-T1)*Math.log(r/r1)/Math.log(r2/r1));
    }

    if(tempChart) tempChart.destroy();
    tempChart=new Chart(document.getElementById("tempChart"),{
        type:"line",
        data:{labels:rArr,datasets:[{label:"Temperature (°C)",data:tArr,borderColor:"#ff5722"}]},
        options:{scales:{
            x:{title:{display:true,text:"Radius (m)"}},
            y:{title:{display:true,text:"Temperature (°C)"}}
        }}
    });

    if(timeChart) timeChart.destroy();
    timeChart=new Chart(document.getElementById("timeChart"),{
        type:"line",
        data:{labels:[0,time],datasets:[{label:"Heat Flow",data:[Qout,Qout],borderColor:"#0b5ed7"}]},
        options:{scales:{
            x:{title:{display:true,text:"Time (s)"}},
            y:{title:{display:true,text:"Heat Flow ("+(unit==="cal"?"cal/sec":"W")+")"}}
        }}
    });
}

calculate();
</script>

</body>
</html>
