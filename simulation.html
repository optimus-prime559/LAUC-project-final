<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Simulation – Fourier’s Law Heat Flow</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:linear-gradient(135deg,#c9f7f5,#e6fffa);
}

header{
    background:#06b6d4;
    color:white;
    padding:18px;
    text-align:center;
}

/* layout */
.container{
    display:grid;
    grid-template-columns:1fr 1.3fr 1.4fr;
    gap:16px;
    padding:16px;
}

.panel{
    background:rgba(255,255,255,0.45);
    backdrop-filter:blur(12px);
    padding:16px;
    border-radius:16px;
    box-shadow:0 10px 25px rgba(0,0,0,0.25);
}

h3{
    margin-top:0;
    border-bottom:2px solid #ddd;
    padding-bottom:6px;
}

/* input alignment */
.input-row{
    display:flex;
    gap:10px;
    margin-bottom:8px;
}
.input-row input{flex:2; padding:8px;}
.input-row select{flex:1; padding:8px;}

input, select{
    width:100%;
}

/* highlighted result */
.result{
    margin-top:12px;
    padding:14px;
    background:linear-gradient(135deg,#ffffff,#e0f2fe);
    border-left:6px solid #06b6d4;
    border-radius:12px;
    box-shadow:0 6px 18px rgba(0,0,0,0.2);
    animation:fadeUp 0.25s ease;
}

@keyframes fadeUp{
    from{opacity:0; transform:translateY(8px);}
    to{opacity:1; transform:translateY(0);}
}

canvas{
    background:white;
    margin-top:10px;
    border-radius:10px;
}

.small{font-size:13px;}
</style>
</head>

<body>

<header>
    <h1>Heat Conduction Simulation (Cylindrical Pipe)</h1>
</header>

<div class="container">

<!-- INPUT -->
<div class="panel">
<h3>Input Parameters</h3>

<label>Inner Radius</label>
<div class="input-row">
    <input id="r1" value="5">
    <select id="r1unit"><option value="0.01">cm</option><option value="1">m</option></select>
</div>

<label>Outer Radius</label>
<div class="input-row">
    <input id="r2" value="7">
    <select id="r2unit"><option value="0.01">cm</option><option value="1">m</option></select>
</div>

<label>Radius for Temperature</label>
<div class="input-row">
    <input id="rq" value="6">
    <select id="rqunit"><option value="0.01">cm</option><option value="1">m</option></select>
</div>

<label>Inner Temperature (°C)</label>
<input id="T1" value="200">

<label>Outer Temperature (°C)</label>
<input id="T2" value="50">

<label>Thermal Conductivity (W/m·K)</label>
<input id="k" value="45">

<label>Pipe Length (m)</label>
<input id="L" value="1">

<label>Time (s)</label>
<input id="time" value="60">

<label>Output Unit</label>
<select id="unit">
    <option value="W">Watt</option>
    <option value="cal">cal/sec</option>
</select>
</div>

<!-- PIPE + MAIN RESULTS -->
<div class="panel">
<h3>Pipe Cross-Section</h3>
<canvas id="pipeCanvas" width="300" height="300"></canvas>

<div id="results" class="result"></div>

<p class="small">
Red = inner hot surface | Blue dashed = selected radius
</p>
</div>

<!-- GRAPHS -->
<div class="panel">
<h3>Graphs</h3>
<canvas id="tempChart"></canvas>
<canvas id="timeChart"></canvas>
</div>

</div>

<script>
let tempChart=null, timeChart=null;

function drawPipe(r1,r2,rq){
    const c=document.getElementById("pipeCanvas");
    const ctx=c.getContext("2d");
    ctx.clearRect(0,0,300,300);

    const cx=150, cy=150;
    const scale=110/r2;

    const R1=r1*scale, R2=r2*scale, RQ=rq*scale;

    const grad=ctx.createRadialGradient(cx,cy,R1,cx,cy,R2);
    grad.addColorStop(0,"#ff5722");
    grad.addColorStop(1,"#ffffff");

    ctx.beginPath();
    ctx.arc(cx,cy,R2,0,2*Math.PI);
    ctx.fillStyle=grad;
    ctx.fill();

    ctx.beginPath();
    ctx.arc(cx,cy,R1,0,2*Math.PI);
    ctx.fillStyle="#fff";
    ctx.fill();
    ctx.stroke();

    ctx.setLineDash([6,4]);
    ctx.beginPath();
    ctx.arc(cx,cy,RQ,0,2*Math.PI);
    ctx.strokeStyle="#0b5ed7";
    ctx.lineWidth=2;
    ctx.stroke();
    ctx.setLineDash([]);

    ctx.font="14px Arial";
    ctx.fillStyle="#000";
    ctx.fillText("r₁ = "+r1.toFixed(3)+" m",cx+R1/2-30,cy-8);
    ctx.fillText("r₂ = "+r2.toFixed(3)+" m",cx+R2/2-30,cy+18);
    ctx.fillText("r = "+rq.toFixed(3)+" m",cx-40,cy-RQ-6);
}

function calculate(){
    const r1=+r1unit.value*+document.getElementById("r1").value;
    const r2=+r2unit.value*+document.getElementById("r2").value;
    const rq=+rqunit.value*+document.getElementById("rq").value;

    if(rq<r1 || rq>r2){
        results.innerHTML="<b style='color:red'>Selected radius must lie between r₁ and r₂</b>";
        return;
    }

    const T1v=+T1.value, T2v=+T2.value;
    const kv=+k.value, Lv=+L.value, timev=+time.value;

    const Q=(2*Math.PI*kv*Lv*(T1v-T2v))/Math.log(r2/r1);
    const Qout=(unit.value==="cal")?Q/4.186:Q;

    const Tr=T1v+(T2v-T1v)*Math.log(rq/r1)/Math.log(r2/r1);

    results.innerHTML=`
<b>Heat Flow Rate:</b> ${Qout.toFixed(3)} ${unit.value==="cal"?"cal/sec":"W"}<br>
<b>Total Heat Transferred (${timev}s):</b> ${(Qout*timev).toFixed(2)}<br>
<b>Temperature at selected radius:</b> ${Tr.toFixed(2)} °C
`;

    drawPipe(r1,r2,rq);

    const rArr=[], tArr=[];
    for(let i=0;i<=20;i++){
        const r=r1+(r2-r1)*i/20;
        rArr.push(r.toFixed(4));
        tArr.push(T1v+(T2v-T1v)*Math.log(r/r1)/Math.log(r2/r1));
    }

    if(tempChart) tempChart.destroy();
    tempChart=new Chart(tempChartCanvas,{
        type:"line",
        data:{labels:rArr,datasets:[{label:"Temperature (°C)",data:tArr,borderColor:"#ff5722"}]},
        options:{scales:{x:{title:{display:true,text:"Radius (m)"}},y:{title:{display:true,text:"Temperature (°C)"}}}}
    });

    if(timeChart) timeChart.destroy();
    timeChart=new Chart(timeChartCanvas,{
        type:"line",
        data:{labels:[0,timev],datasets:[{label:"Heat Flow",data:[Qout,Qout],borderColor:"#0b5ed7"}]},
        options:{scales:{x:{title:{display:true,text:"Time (s)"}},y:{title:{display:true,text:"Heat Flow"}}}}
    });
}

const tempChartCanvas=document.getElementById("tempChart");
const timeChartCanvas=document.getElementById("timeChart");

["r1","r2","rq","T1","T2","k","L","time","unit","r1unit","r2unit","rqunit"]
.forEach(id=>{
    document.getElementById(id).addEventListener("input",calculate);
    document.getElementById(id).addEventListener("change",calculate);
});

calculate();
</script>

</body>
</html>
